<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lista de Funcionários</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <style>
        .rodape {
            text-align: center;
            position: fixed;
            width: 100%;
            bottom: 0;
            background-color: #f8f9fa;
            padding: 10px 0;
        }
    </style>
    <script>

        function exclui(Matricula) {
            const swalWithBootstrapButtons = Swal.mixin({
                customClass: {
                    confirmButton: "btn btn-success",
                    cancelButton: "btn btn-danger"
                },
                buttonsStyling: false
            });
            swalWithBootstrapButtons.fire({
                title: "Remover Funcionario",
                text: "Deseja realmente excluir?",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Sim",
                cancelButtonText: "Não",
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                url: "/funcionario/apagar/" + Matricula,
                type: "DELETE",
                sucess: function (res){
                    $(location).attr('href', '/funcionario/listar');
                },
            });
                } else if (
                    /* Read more about handling dismissals below */
                    result.dismiss === Swal.DismissReason.cancel
                ) {
                    swalWithBootstrapButtons.fire({
                        title: "Cancelado com sucesso",
                        text: ":)",
                        icon: "error"
                    });
                }
            });
        }
    </script>

</head>

<body>
    <div class="container py-4">
        <h1 class="text-center">Setor Administrativo - Titanium</h1>
        <br>

        <!-- Abas de Navegação -->
        <ul class="nav nav-tabs mb-4">
            <li class="nav-item"><a class="nav-link" href="http://localhost:3000/cliente/listar">Clientes</a></li>
            <li class="nav-item"><a class="nav-link active"
                    href="http://localhost:3000/funcionario/listar">Funcionários</a></li>
            <li class="nav-item"><a class="nav-link" href="http://localhost:3000/pagamento/listar">Pagamentos</a></li>
            <li class="nav-item"><a class="nav-link" href="http://localhost:3000/horario/listar">Horários</a></li>
        </ul>

        <div class="tab-content">
            <!-- Funcionários -->
            <div class="tab-pane fade show active" id="funcionario">
                <a href="http://localhost:3000/funcionario/add" class="btn btn-primary"
                    style="margin-bottom: 10px;">Adicionar Funcionário</a>
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for (let item of resultado) { %>
                            <tr>
                                <td>
                                    <%= item.Nome %>
                                </td>
                                <td>
                                    <a href="/funcionario/editar/<%=item.Matricula%>"
                                        class="btn btn-outline-secondary">Editar</a>
                                    <button type="button" class="btn btn-danger" onclick="exclui()">Excluir</button>
                                    <!-- Botão para abrir modal -->
                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                        data-bs-target="#modal-<%= item.Matricula %>">Sobre</button>
                                </td>
                            </tr>

                            <!-- Modal -->
                            <div class="modal fade" id="modal-<%= item.Matricula %>" tabindex="-1"
                                aria-labelledby="modalLabel-<%= item.Matricula %>" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Informações do Funcionário</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <ul>
                                                <li><strong>Nome:</strong>
                                                    <%= item.Nome %>
                                                </li>
                                                <li><strong>Telefone:</strong>
                                                    <%= item.contato %>
                                                </li>
                                                <li><strong>Data de Nascimento:</strong>
                                                    <%= item.Aniversario %>
                                                </li>
                                                <li><strong>CPF:</strong>
                                                    <%= item.Cpf %>
                                                </li>
                                                <li><strong>Matrícula:</strong>
                                                    <%= item.Matricula %>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <footer class="rodape"><b>&copy; Todos Direitos Reservados TitaniumFit</b></footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>